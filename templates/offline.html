<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sin conexión — UN Amigote Espera</title>
  
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#ffd166;
      --muted:#9aa4b2;
      --glass: rgba(255,255,255,0.03);
    }
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Helvetica Neue", Arial;
      background:
        radial-gradient(ellipse at 10% 10%, rgba(255,209,102,0.06), transparent 10%),
        linear-gradient(180deg,#071026 0%, #071020 100%);
      color:#e6eef6;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .card{
      width:100%;
      max-width:760px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
      padding:28px;
      display:grid;
      grid-template-columns: 120px 1fr;
      gap:20px;
      align-items:center;
      border: 1px solid rgba(255,255,255,0.03);
    }

    .logo-wrap{
      display:flex;
      align-items:center;
      justify-content:center;
      background: var(--glass);
      border-radius:10px;
      padding:12px;
      height:120px;
    }
    .logo-wrap img{ max-width:100%; height:96px; object-fit:contain; }

    h1{
      margin:0 0 6px 0;
      font-size:22px;
      letter-spacing:-0.2px;
    }
    p.lead{
      margin:0 0 14px 0;
      color:var(--muted);
      line-height:1.45;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:8px;
    }

    .btn{
      appearance:none;
      border:0;
      background:var(--accent);
      color:#071020;
      padding:10px 14px;
      border-radius:10px;
      font-weight:600;
      cursor:pointer;
      box-shadow: 0 6px 18px rgba(255,209,102,0.12);
    }
    .btn.ghost{
      background:transparent;
      color:var(--muted);
      border:1px solid rgba(255,255,255,0.04);
    }

    .hint{
      margin-top:12px;
      color:var(--muted);
      font-size:13px;
    }

    footer{
      grid-column: 1 / -1;
      margin-top:10px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      color:var(--muted);
      font-size:13px;
    }

    @media (max-width:600px){
      .card{ grid-template-columns: 1fr; text-align:center; }
      .logo-wrap{ margin:0 auto; }
      footer{ flex-direction:column; gap:8px; align-items:center; }
    }
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="offline-title">
    <div class="logo-wrap" aria-hidden="true">
      <img src="/static/img/logo.png" alt="logo" />
    </div>

    <div>
      <h1 id="offline-title">Parece que estás desconectado</h1>
      <p class="lead">No te preocupes — algunas funciones necesitan conexión a internet. Puedes seguir navegando en lo que está en caché o volver en unos segundos.</p>

      <div class="actions">
        <button class="btn" id="reload">Intentar reconectar</button>
        <button class="btn ghost" id="open-dashboard">Ir al tablero (si está en caché)</button>
      </div>

      <p class="hint">Si sigues sin conexión, verifica tu red o usa la aplicación local. Si el problema persiste, recarga esta página cuando vuelvas a tener conexión.</p>
    </div>

    <footer>
      <div>UN Amigote Espera</div>
      <div id="status">Estado: <strong>offline</strong></div>
    </footer>
  </div>

  <script>
    const reloadBtn = document.getElementById('reload');
    const dashBtn = document.getElementById('open-dashboard');
    const statusEl = document.getElementById('status');

    reloadBtn.addEventListener('click', () => {
      // intenta recargar la página para forzar fetch/Service Worker
      location.reload();
    });

    dashBtn.addEventListener('click', async () => {
  const url = '/dashboard-graficas';
  if ('caches' in window) {
    try {
      const cache = await caches.open('unamigoteeespera-cache-v15'); // <- nombre correcto
      const cached = await cache.match(url);
      if (cached) {
        // si está en caché, navegamos a la URL (se servirá desde cache)
        window.location.href = url;
        return;
      }
    } catch (e) {
      // ignore
    }
  }
  alert('El tablero no está disponible en caché.');
});


    // actualizar indicador visual de conexión
    function updateOnlineStatus() {
      const online = navigator.onLine;
      statusEl.innerHTML = 'Estado: <strong>' + (online ? 'online' : 'offline') + '</strong>';
    }
    window.addEventListener('online', updateOnlineStatus);
    window.addEventListener('offline', updateOnlineStatus);
    updateOnlineStatus();
  </script>
</body>
</html>
